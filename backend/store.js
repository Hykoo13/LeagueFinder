const { v4: uuidv4 } = require('uuid');

// In-memory data stores
const users = new Map(); // userId -> { userId, username, socketId, friends: Set(userId), pendingInvites: Array({fromUserId, roomId}) }
const socketUserMap = new Map(); // socketId -> userId (for quick lookup on disconnect)
const rooms = new Map(); // roomId -> Room object

const dictionary = {
    "champions": ["Aatrox", "Ahri", "Akali", "Akshan", "Alistar", "Ambessa", "Amumu", "Anivia", "Annie", "Aphelios", "Ashe", "Aurelion Sol", "Aurora", "Azir", "Bard", "Bel'Veth(Belveth)", "Blitzcrank", "Brand", "Braum", "Briar", "Caitlyn", "Camille", "Cassiopeia", "Cho'Gath", "Corki", "Darius", "Diana", "Dr. Mundo", "Draven", "Ekko", "Elise", "Evelynn", "Ezreal", "Fiddlesticks", "Fiora", "Fizz", "Galio", "Gangplank", "Garen", "Gnar", "Gragas", "Graves", "Gwen", "Hecarim", "Heimerdinger", "Hwei", "Illaoi", "Irelia", "Ivern", "Janna", "Jarvan IV", "Jax", "Jayce", "Jhin", "Jinx", "K'Sante", "Kai'Sa", "Kalista", "Karma", "Karthus", "Kassadin", "Katarina", "Kayle", "Kayn", "Kennen", "Kha'Zix", "Kindred", "Kled", "Kog'Maw", "LeBlanc", "Lee Sin", "Leona", "Lillia", "Lissandra", "Lucian", "Lulu", "Lux", "Malphite", "Malzahar", "Maokai", "Master Yi", "Mel", "Milio", "Miss Fortune", "Mordekaiser", "Morgana", "Naafiri", "Nami", "Nasus", "Nautilus", "Neeko", "Nidalee", "Nilah", "Nocturne", "Nunu & Willump", "Olaf", "Orianna", "Ornn", "Pantheon", "Poppy", "Pyke", "Qiyana", "Quinn", "Rakan", "Rammus", "Rek'Sai", "Rell", "Renata Glasc", "Renekton", "Rengar", "Riven", "Rumble", "Ryze", "Samira", "Sejuani", "Senna", "Seraphine", "Sett", "Shaco", "Shen", "Shyvana", "Singed", "Sion", "Sivir", "Skarner", "Smolder", "Sona", "Soraka", "Swain", "Sylas", "Syndra", "Tahm Kench", "Taliyah", "Talon", "Taric", "Teemo", "Thresh", "Tristana", "Trundle", "Tryndamere", "Twisted Fate", "Twitch", "Udyr", "Urgot", "Varus", "Vayne", "Veigar", "Vel'Koz", "Vex", "Vi", "Viego", "Viktor", "Vladimir", "Volibear", "Warwick", "Wukong", "Xayah", "Xerath", "Xin Zhao", "Yasuo", "Yone", "Yorick", "Yunara", "Yuumi", "Zaahen", "Zac", "Zed", "Zeri", "Ziggs", "Zilean", "Zoe", "Zyra"],
    "items": ["Abatteur", "Actualisateur", "Alteration divinatoire", "Alternateur Hextech", "Ange Gardien", "Anneau de Doran", "Approche de l'hiver", "Arc axiomatique", "Arc courbe", "Arc-bouclier immortel", "Armure d'étoffe", "Armure de Warmog", "Armure roncière", "Armure sanguine", "Atlas", "Au bout du rouleau", "Aube et crépuscule", "Avancée blindée", "Baguette explosive", "Baguette trop grosse", "Balise camouflée (ward)", "Balise de contrôle (pink)", "Barrière verdoyante", "Bâton de l'archange", "Bâton des flots", "Bâton du Vide", "Bâton séculaire", "Biscuit", "Bénédiction de Mikael", "BF Glaive", "Bottes", "Bottes de célérité", "Bottes de lucidité", "Bouclier de Doran", "Bouclier glacial", "Bracelet cristallin", "Brillance", "Brise-coques", "Briseur de bastion", "Brouilleur oraculaire", "Broyeuses à chaînes", "Brutaliseur", "Canon ultrarapide", "Cape d'agilité", "Cape de néant", "Carquois zénithien", "Catalyseur de l'éternité", "Ceinture de mercure", "Ceinture du géant", "Ceinture-roquette Hextech", "Célérité martiale", "Cendres de Bami", "Cendres fatidiques", "Chant de guerre de Shurelya", "Chapitre perdu", "Charme féérique", "Chasseur de monstres", "Chaussures de lanceur de sorts", "Chaussures de sorcier", "Ciel éventré", "Cimeterre mercuriel", "Codex mephitique", "Coeur de l'aube", "Cœur gelé", "Coeuracier", "Coiffe de Rabadon", "Collier rafraîchissant", "Concentration lointaine", "Convergence de Zeke", "Coques en acier", "Corne du gardien", "Cotte de mailles", "Cotte épineuse", "Couperet noir", "Créateur de failles", "Cristal de rubis", "Cristal de saphir", "Crochet de serpent", "Cyclosabre voltaïque", "Dague", "Dague dentelée", "Danse de la mort", "Danseur fantôme", "Déguisement hanté", "Dent de Nashor", "Dernier souffle", "Désespoir infini", "Diadème des murmures", "écho de Luden", "échos d'Helia", "Éclipse", "Égide solaire", "Élixir de fer", "Élixir de rage", "Élixir de sorcellerie", "Encensoir ardent", "Épée dentelée chimico-punk", "Épée longue", "Estropieur", "Faim insatiable", "Faux spectrale", "Feu follet éthéré", "Flamme-ombre", "Fléau de liche", "Flèches des Yun Tal", "Fleur de crypte", "Flutes de Bandle", "Force de la nature", "Force de la trinité", "Foreuse", "Fronde de l'éclaireur", "Gage de Sterak", "Gantelet givrant", "Gemme exaltante", "Glaive d'ombre", "Gueule de Malmortius", "Hache d'âtrinsèque", "Harnais protoplasmique", "Hexplaque expérimentale", "Hexterminateur", "Hydre profane", "Hydre titanesque", "Hydre vorace", "Idole interdite", "Jak'Sho le Protéiforme", "Jambières du métal", "Jambières du berzerker", "Joyau putréfiant", "Lame d'infini", "Lame de Doran", "Lame du gardien", "Lame du roi déchu", "Lame enragée de Guinsoo (guinsoo)", "Lame spectre de Youmuu (Youmuu)", "Lame tempête", "Lance de Shojin", "Larme de la déesse", "Lucidité pourpre", "Lunettes Hextech C44", "Mailles du gardien", "Malédiction du sanguinaire", "Malfaisance", "Manamune", "Mandat impérial", "Manteau de la nuit", "Manteau de Négatron", "Manteau de spectre", "Marque du bourreau", "Marteau de Caulfield", "Marteau du gardien", "Masque abyssal", "Médaillon de l'Iron Solari", "Mélodie du sang", "Miroir en verre de Bandle", "Morellonomicon", "Onde orageuse", "Opportunité", "Opposition céleste", "Orbre de l'oubli", "Orbe du gardien", "Orgueil", "Ouragan de Runaan", "Percepteur", "Phage", "Pioche", "Pique dimensionelle de Zaz'Zak", "Pistolame Hextech", "Plaque de lune ailée", "Plaque du mort", "Poignard de Statikk", "Potion de soin", "Potion rechargeable", "Poussière luisante", "Présage de Randuin", "Protège bras du savant", "Rancune de Serylda", "Rappel mortel", "Rayonnement du vide", "Rectrix", "Rédemption", "Régénérateur de pierre de lune", "Rêve éveillé", "Rite des ruines", "Rookern kaénique", "Sablier de Zhonya", "Sac de l'explorateur", "Salutations de Dominik", "Sandales de Mercure", "Sceau d'acier", "Sceau noir", "Sceptre de Rylai (Rylai)", "Sceptre vampirique", "Soif-de-sang", "Terminus", "Tiamat", "Tome d'amplification", "Torche noire", "Tourment de Liandry", "Traîneau du solstice", "Tremblelame navori (navori)", "Tueur de krakens (kraken)", "Visage spirituel", "Vœu du chevalier", "Voile de la banshee", "Voleur d'âmes de Mejai (Mejai)", "Volonté cosmique", "Zèle"],
    "lol": ["Drake", "Nashor", "Grubs", "Raptors", "Gromp", "Krugs", "Red Buff", "Blue Buff", "Loups", "Gank", "ping", "freeze", "creep", "tour", "nexus", "lane", "champion", "mid", "bot", "top", "jungle", "adc", "ap", "ad", "tank", "bruiser", "assassin", "mage", "tireur", "support", "autofill", "pentakill", "Triplé", "Premier sang", "carry", "jungle gap", "Saut éclair(flash)", "embrasement(ignite)", "barrière", "téléportation", "fatigue(exhaust)", "Soin(Heal)", "Purge", "Châtiment(Smite)", "Fanôme(Ghost)", "étourdi (stun)", "dans les airs(bump)", "combo", "level", "ultime", "Wombo Combo", "bodyblock", "melée", "range", "golds", "xp", "fer", "argent", "or", "platine", "émeraude", "diamant", "master", "grand master", "challenger", "Riot"],
    "esport": ["T1", "G2", "KC", "LFL", "LPL", "LCK", "Worlds", "Fnatics", "Gen G", "DRX", "Mad lions", "BDS", "Vitality", "Faker", "Keria", "Hansama", "Zeus", "Adam", "Caps", "Showmaker", "Chovy", "Rekkles", "Bin", "Gumayusi", "Peanut", "Caliste", "Saken", "Ruler", "Viper", "Knight", "Yellowstar", "Cabochar", "Exakick", "Targamas", "Isma"],
    "streamers": ["Sixen", "Slipix", "Hawnie", "Aloonea", "Tiky", "Nisqy", "Splinter", "Stray", "Trayton", "Ekkosuna", "Nattynatt", "Raiko", "Beifeng", "Domingo", "Kameto", "Byilhan", "Doigby", "Wakz", "Crocodyle", "Thebausffs", "Hiro", "Pinkward", "Inoxtag", "Alderiate", "Pandore", "Rhobalas", "Kataevolved", "Skyart", "Bubulle", "Potent", "Helydia", "Yokah", "Kazewa", "Walou", "Gaethan", "Blanquette", "IReaz", "Peyjem", "Grimkujow", "Maxime Biaggi", "Wao", "Linca", "Chreak", "Phantasm", "Idizy", "Dantes"]
};

// Generate a random 4-letter room code
function generateRoomCode() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    let code = '';
    for (let i = 0; i < 4; i++) {
        code += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return code;
}

module.exports = {
    users,
    socketUserMap,
    rooms,
    dictionary,
    generateRoomCode
};
